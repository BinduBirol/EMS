
<form id="edit_form" action="emp_profile_add_edit_do" method="post" enctype="multipart/form-data">
<div class="content-wrapper">


<section class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1>Edit Employee</h1>
          </div>
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="/">Home</a></li>
              <li class="breadcrumb-item">employee_list</li>
              <li class="breadcrumb-item active">employee_profile_edit</li>              
            </ol>
          </div>
        </div>
      </div><!-- /.container-fluid -->
    </section>


<section class="content">
      <div class="container-fluid">
      
      
      
        <!-- /.row -->
        
        <div class="card card-success">
          <div class="card-header">
            <h3 class="card-title">Employee user Info</h3>

            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
              </button>              
            </div>
          </div>
          <!-- /.card-header -->
          <div class="card-body">
            
            <!-- /.row -->

            
            <div class="row">
              <div class="col-12 col-sm-6 text-center ">
                <div  class="">
                  
                        <img  th:src="*{'data:image/jpeg;base64,'+{emp_info.emp_image_encoded}}"
					class="profile-user-img img-fluid img-circle">
					
						
					
					
					
                </div>
                <p></p>  
                <h4>[[${emp_info.first_name}]] [[${emp_info.last_name}]]</h4>                 
                 
                 <p>From <b>[[${emp_info.contract_start}]]</b> To <b>[[${emp_info.contract_end}]]</b></p>      
               
                <!-- /.form-group -->
              </div>   
              
              <div class="col-12 col-sm-6">
              
              <div class="form-group">
                  
					<small class="img_size_warning">Maximum permitted size of 1048576 bytes (1MB)</small>
					<br/>
					<div class="form-group"> 				  					    
					    
					  <input type="file" class="" id="emp_image" accept="image/*" name="emp_image_m"/>
                      
					  
					  
					</div>
					
					
                </div>   
              
              
              
								<div class="row">
									<div class="col">
										<label>User Role</label> <select name="roleid"
											required="required" class="form-control" id="slct_role">
											<option value="">Select Role</option>
											<option th:selected="(${roles.id} == *{emp_info.roleid})"
												th:each="roles : ${roles}" th:value="${roles.id}"
												th:text="${roles.description}"></option>
										</select>
									</div>

									<div class="col">
										<label>Activity status</label>
										<div class="input-group date" data-target-input="nearest">

											<select name="status" required="required"
												class="form-control">
												<option value="">Select</option>
												<option th:selected="${emp_info.status eq true}" value="1">Active</option>
												<option th:selected="${emp_info.status eq false}" value="0">Inactive</option>
											</select>

										</div>
									</div>
								</div>
								

								<div class="row">
									<div class="col">
										<label>UserName</label> <input name="username"
											th:value="${emp_info.username}" required="required"
											readonly="readonly" type="text"
											class="form-control datetimepicker-input" />

									</div>
									<div class="col">
										<label>User ID</label> <input name="userid"
											th:value="${emp_info.userid}" readonly="readonly" type="text"
											class="form-control" required="required" id="userid"
											placeholder="Auto generated userID">
											
											<input name="empid"
											th:value="${emp_info.empid}" readonly="readonly" type="hidden" id="empid"
											class="form-control" required="required" 
											>
									</div>
								</div>

							</div>
                
                <!-- /.form-group -->
              </div>          
              
            </div>
            
            
            
            
            
            
            
            
          </div>
          <!-- /.card-body -->
          
        </div>
      
      
      
      
      
      
      
        <!-- SELECT2 EXAMPLE -->
        <div class="card card-primary">
          <div class="card-header">
            <h3 class="card-title">Employee Personal Info</h3>

            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
              </button>
             
            </div>
          </div>
          <!-- /.card-header -->
          <div class="card-body">
            
            <!-- /.row -->

            
            <div class="row">
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>First Name</label>
                 <input name="first_name" type="text" th:value="${emp_info.first_name}" class="form-control"  required="required" placeholder="Enter First Name">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Last Name</label>
                  <input name="last_name" type="text" th:value="${emp_info.last_name}" class="form-control"  required="required" placeholder="Enter Last Name">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
            </div>
            
            
            <div class="row">
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Private Email</label>
                 <input name="private_email" th:value="${emp_info.private_email}" type="email" class="form-control"  required="required" placeholder="Enter Private Email">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Closest Relative Full Description</label>
                  <input name="closest_relative_full" th:value="${emp_info.closest_relative_full}" type="text" class="form-control"  required="required" placeholder="Enter Closest Relative Full Description">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
            </div>
            
             <div class="row">
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Full Address</label>
                 <input name="address_full" th:value="${emp_info.address_full}"   type="text" class="form-control"  required="required" placeholder="Enter Full Address">
                </div>
                <!-- /.form-group -->                
              </div>
              <!-- /.col -->
               <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Evening Phone</label>
                 <input name="phone_eve" type="tel" th:value="${emp_info.phone_eve}" class="form-control"  required="required" placeholder="Enter Evening Phone">
                </div>
                <!-- /.form-group -->                
              </div>
              <!-- /.col -->
            </div>
            
             <div class="row">
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Social Security Number</label>
                 <input name="social_security_number" th:value="${emp_info.social_security_number}" type="text" class="form-control"  required="required" placeholder="Enter Social Security Number">
                </div>
                <!-- /.form-group -->                
              </div>
              <!-- /.col -->
               <div class="col-12 col-sm-6">
                <div class="form-group">
                 
                 
                </div>
                <!-- /.form-group -->                
              </div>
              <!-- /.col -->
            </div>
            
            
          </div>
          <!-- /.card-body -->
          <div class="card-footer">
            <small >Include Street, State/Ort, Zipcode/Postkod in the relative and address information</small>
          </div>
        </div>
        <!-- /.card -->

        <!-- SELECT2 EXAMPLE -->


 	<!-- SELECT2 EXAMPLE -->
        <div class="card card-info">
          <div class="card-header">
            <h3 class="card-title">Employment Info</h3>

            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
              </button>
              
            </div>
          </div>
          <!-- /.card-header -->
          <div class="card-body">
            
            <!-- /.row -->

            
            <div class="row">
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Designation</label>                 
                <select name="designation"
											required="required" class="form-control" id="slct_role">
											<option value="">Select Role</option>
											<option th:selected="(${roles.id} == *{emp_info.designation})"
												th:each="roles : ${roles}" th:value="${roles.id}"
												th:text="${roles.description}"></option>
										</select>
                
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Workspace</label>
                  <input name="workspace" th:value="${emp_info.workspace}" type="text" class="form-control"  required="required" placeholder="Enter Workspace">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
            </div>
            
            
            <div class="row">
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Work Email</label>
                 <input name="email" type="email" th:value="${emp_info.email}" class="form-control"  required="required" placeholder="Enter Work Email">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Nearest Chief</label>
                  <input name="nearest_chief" th:value="${emp_info.nearest_chief}" type="text" class="form-control"  required="required" placeholder="Enter Nearest Chief">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
            </div>
            
             <div class="row">
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Employee Type</label>                 
                 
                 			<select name="employee_Type" required="required" class="form-control"
									id="slct_type">
									<option value="">Select Type</option>
									<option th:selected="(${type.typeid} == *{emp_info.employee_Type})"
										th:each="type : ${type}" th:value="${type.typeid}"
										th:text="${type.type_name}"></option>
								</select>


							</div>
                <!-- /.form-group -->                
              </div>
              <!-- /.col -->
               <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Work Phone</label>
                 <input name="phone" type="tel" th:value="${emp_info.phone}" class="form-control"  required="required" placeholder="Enter Work Phone">
                </div>
                <!-- /.form-group -->                
              </div>
              <!-- /.col -->
            </div>

					<div class="row">
						<div class="col-12 col-sm-6">
							<div class="form-group">
								<label>Contact Start</label>					
								<div class="input-group" 
									data-target-input="nearest">
									<input name="contract_start" th:value="${emp_info.contract_start}" required="required" type="date" class="form-control" />
									
								</div>
								
							</div>
						</div>
						
						<div class="col-12 col-sm-6">
							<div class="form-group">
								<label>Contact End</label>
								<div class="input-group" 
									data-target-input="nearest">
									<input name="contract_end" th:value="${emp_info.contract_end}" required="required" type="date" class="form-control" />									
								</div>
							</div>
						</div>

					</div>
					
					


				</div>
          <!-- /.card-body -->
          <div class="card-footer">
            
          </div>
        </div>
        <!-- /.card -->

        <!-- SELECT2 EXAMPLE -->





<div class="card card-warning">
          <div class="card-header">
            <h3 class="card-title">Employee Account Info</h3>

            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
              </button>
              
            </div>
          </div>
          <!-- /.card-header -->
          <div class="card-body">
            
            <!-- /.row -->

            
            <div class="row">
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Bank Name</label>
                 <input name="bank_name" th:value="${emp_info.bank_name}" type="text" class="form-control" required="required" placeholder="Enter Bank Name">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Account Number</label>
                  <input name="account_number" th:value="${emp_info.account_number}" type="text" class="form-control"  required="required" placeholder="Enter Bank Account Number">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
            </div>
            
            
            <div class="row">
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Clearing Number</label>
                 <input name="clearing_number" th:value="${emp_info.clearing_number}" type="text" class="form-control"  required="required" placeholder="Enter Clearing Number">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  <label>Table Tax</label>
                  <input name="table_tax" th:value="${emp_info.table_tax}" type="text" class="form-control"  required="required" placeholder="Enter Table Tax">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
            </div>
            
            
            
            
          </div>
          <!-- /.card-body -->
          <div class="card-footer">
            
          </div>
        </div>
        <!-- /.card -->

        

		<div class="card card-dark">
          <div class="card-header">
            <h3 class="card-title">Documents</h3>

            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
              </button>
              
            </div>
          </div>
          <!-- /.card-header -->
          <div class="card-body">
            
            <!-- /.row -->

            
            <div class="row">
              <div class="col-12 col-sm-4">
                <div class="form-group">
                  <label>CV <a th:href="|download/user?fileId=cv&userid=${emp_info.userid}|">Download</a></label> <br/>
                 <input name="doc_m_cv" accept="application/pdf"  type="file" class="inputfile"  placeholder="Enter CV">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
              <div class="col-12 col-sm-4">
                <div class="form-group">
                  <label>Cetificate <a th:href="|download/user?fileId=crt&userid=${emp_info.userid}|">Download</a></label> <br/>
                  <input name="doc_m_crt" accept="application/pdf"  type="file" class="inputfile"   placeholder="Enter Certificate copy">
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
              
               <div class="col-12 col-sm-4">
                <div class="form-group">
                  <label>ID copy <a th:href="|download/user?fileId=id&userid=${emp_info.userid}|">Download</a></label><br/>
                  <input name="doc_m_id" accept="image/jpeg,image/png,application/pdf"  type="file" class="inputfile"   placeholder="Enter ID copy">
                </div>
                <!-- /.form-group -->
              </div>
              
             
            </div>            
          </div>
          <!-- /.card-body -->
          <div class="card-footer">
            <small class="img_size_warning">Maximum permitted size of 1048576 bytes (1MB)</small><br/>
            <small class="img_size_warning">Only .pdf file allowed for CV and Certificates. Photo can be uploaded as ID copy.</small>
          </div>
        </div>
		




		<div class="row">
		
			 <!-- /.col -->
              <div class="col-12 col-sm-3">
                <div class="form-group">
                  
                </div>
                <!-- /.form-group -->
              </div>
              <!-- /.col -->
              <div class="col-12 col-sm-6">
                <div class="form-group">
                  
                 <input type="submit" class="form-control btn btn-success" id="submit" value="Submit Modification">
             
                </div>
                <!-- /.form-group -->
              </div>
              
              <div class="col-12 col-sm-3">
                <div class="form-group">
                  
                 
                </div>
                <!-- /.form-group -->
              </div>
             
            </div>





</div>
        
        
        </section></div>
        
        
   </form>     
        
        
        <!-- Select2 -->
<script th:src="@{/assets/plugins/select2/js/select2.full.min.js}"></script>
<!-- Bootstrap4 Duallistbox -->
<script th:src="@{/assets/plugins/bootstrap4-duallistbox/jquery.bootstrap-duallistbox.min.js}"></script>
<!-- InputMask -->
<script th:src="@{/assets/plugins/moment/moment.min.js}"></script>
<script th:src="@{/assets/plugins/inputmask/jquery.inputmask.min.js}"></script>
<!-- date-range-picker -->
<script th:src="@{/assets/plugins/daterangepicker/daterangepicker.js}"></script>
<!-- bootstrap color picker -->
<script th:src="@{/assets/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.min.js}"></script>
<!-- Tempusdominus Bootstrap 4 -->
<script th:src="@{/assets/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js}"></script>
<!-- Bootstrap Switch -->
<script th:src="@{/assets/plugins/bootstrap-switch/js/bootstrap-switch.min.js}"></script>
<!-- BS-Stepper -->
<script th:src="@{/assets/plugins/bs-stepper/js/bs-stepper.min.js}"></script>
<!-- dropzonejs -->
<script th:src="@{/assets/plugins/dropzone/min/dropzone.min.js}"></script>


<script>
/*
$("#edit_form").submit(function(e) {

    //alert(1);
	e.preventDefault(); // avoid to execute the actual submit of the form.
    var form = $(this);
    var actionUrl = form.attr('action');
    
    $.ajax({
        type: "POST",
        url: actionUrl,
        data: new FormData(this), // serializes the form's elements.
        success: function(data)
        {
          //alert(data); // show response from the php script.
          ajaxResponse(data);
          //reloadEmp();
        }
    });
    
});
*/

$("#edit_form").submit(function(event)
		{
		    event.preventDefault();
		    $.ajax({
		        url: $(this).attr("action"),
		        type: $(this).attr("method"),
		        //dataType: "JSON",
		        data: new FormData(this),
		        processData: false,
		        contentType: false,
		        success: function (data, status)
		        {
		          	//alert(status);
		        	ajaxResponse(data);
		        	pagereload();
		        },
		        error: function (xhr, desc, err)
		        {
		        	ajaxResponse(err);
		        	pagereload();

		        }
		    });        

		});

$('.inputfile').bind('change', function() {

	  //this.files[0].size gets the size of your file.
	  //alert(this.files[0].size);
	  $size=this.files[0].size
	  if($size>=1048576){
		 alert("File too large!"); 
		 this.value="";
		 $(".img_size_warning").addClass("text-danger");
	  }

});

function ajaxResponse(data) {
	
	var Toast = Swal.mixin({
	    toast: true,
	    position: 'top-end',
	    showConfirmButton: false,
	    timer: 3000
	  });
	  
	
	    $(document).Toasts('create', {
	      class: 'bg-info',
	      title: 'Response',
	      subtitle: 'Success',
	      body: data
	    })
}

function pagereload() {	
	$id= $("#empid").val();
	$navLink = 'emp_profile_edit&emp_id='+$id;				
	$.ajax({
		url : 'getNavPage?navid=' + $navLink,
		type : 'GET',
		success : function(data) {
			$('#page_content_ajax').html("");
			$("#page_content_ajax").fadeOut();
			$('#page_content_ajax').html(data);
			$("#page_content_ajax").fadeIn("slow");
			document.title = $navLink;			
		}
	});

}


	
</script>